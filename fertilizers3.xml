<?xml version="1.0" encoding="UTF-8"?>

<vxml version = "2.1">

<meta name="maintainer" content="j.n.schermer@gmail.com" />
 

<form id="mainMenu">

  <field name="firstOption">
		<prompt>
			Enter 1 if you want to know which fertilizer you need to use, enter 2 if you would like
			to know how to apply a particular fertilizer.
		</prompt>

     <!-- This grammar is specifically for recognizing dtmf. -->
     <grammar xml:lang="en-US" root = "MYRULE" mode="dtmf">
      <rule id="MYRULE" scope = "public">
        <one-of>
          <item> 1 </item>
          <item> 2 </item>
        </one-of>
       </rule>
     </grammar>

		<if cond = "firstOption == 1">
			<goto next="#chooseCrop" />

		<elseif cond="firstOption == 2" />
			<goto next="#chooseFertilizer" />		


  <noinput>
		 <prompt>
				I did not hear you. Please try again.
		 </prompt>
		 <reprompt/>
  </noinput>

		<nomatch>
			 <prompt>
					Is that a number? Please try again.
			 </prompt>
			 <reprompt/>
		</nomatch>
 </field>


</form>

 
	
	
		 <script>
            <![CDATA[
				
				i
				 var crop = application.crop
				 var weahter = application.weahter

				// Open CSV file
				
				
				// Create dictioniary from CSV file [{C,W,F}]

				for (var i = 0; i < len ; i++):
					if (crop === c && weahter === w){
							//waarde van F
					};
				// 
         // iterate through array
         for (var i = 0; i < len; i++) {

           // check if DTMF 
           if (application.lastresult$[i].confidence > .7) {
             confident_count++;
           }
         }

        ]]>
        </script>	


<form id="chooseCrop">

   <field name="crop" slot="crop">
   
		 <grammar xml:lang="en-US" root = "RESPONSE" mode = "DTMF">
    		<rule id="RESPONSE">
				 <one-of>
					 <item> 1 </item>
					 <item> 2 </item>
					 <item> 3 </item>
				 </one-of>
				</rule>
			 </grammar>

    <prompt bargein="true">
      Which crop are you harvesting? Select 1 for rice, 2 for chocolate and 3 for pumpkin, or say the name of your crop.
    </prompt>

		<filled namelist="processAnswers" mode = "all">
				<if cond = "chooseCrop == 1">
					 <var name="crop" expr="rice"/>
				<elseif cond = "chooseCrop == 2">
					 <var name="crop" expr="chocolate"/>
				<elseif cond = "chooseCrop == 3">
					 <var name="crop" expr="pumpkin"/>
		</filled>
		
	</field>
</form>
			

<form id="chooseWeahter">

   <field name="weahter" slot="weahter">
   
		 <grammar xml:lang="en-US" root = "RESPONSE" mode = "DTMF">
    		<rule id="RESPONSE">
				 <one-of>
					 <item> 1 </item>
					 <item> 2 </item>
					 <item> 3 </item>
				 </one-of>
				</rule>
			 </grammar>

    <prompt bargein="true">
			<!--Maybe we can also use data from the internet & location of the user-->
      What is the weather condition? Select 1 for rain, 2 for dry and 3 for cold.
    </prompt>

		<filled namelist="processAnswers" mode = "all">
				<if cond = "chooseWeahter == 1">
					 <var name="weather" expr="rain"/>
				<elseif cond = "chooseWeahter == 2">
					 <var name="weather" expr="dry"/>
				<elseif cond = "chooseWeahter == 3">
					 <var name="weather" expr="cold"/>
		</filled>
		
	</field>
</form>
	
	
	 <prompt bargein="true">
      What kind of weather condition is it? Select 1 for Rain, 2 for dry and 3 for cold.
   </prompt>
		
		<filled namelist="processAnswers" mode = "all">
  		<if cond = "chooseCrop == 1">
				 <var name="crop" expr="rice"/>
			<elseif cond = "chooseCrop == 2">
				 <var name="crop" expr="chocolate"/>
			<elseif cond = "chooseCrop == 3">
				 <var name="crop" expr="pumpkin"/>
  </filled>
		 
			 
	
 

  <filled namelist="decideWhichFertilizer" mode="all">
   <if cond="crop == 'rice'">
     <goto next="#decideOnWeather" />
   <elseif cond="confirm == 'no'" />
    <prompt>
       Thank you! Goodbye!
    </prompt>
   </if>
  </filled>
		
</form>


<form id="playAgain">

   <field name="confirm" slot="confirm">

   <grammar xml:lang="en-US" root = "RESPONSE">
    <rule id="RESPONSE">
     <one-of>
       <item> yes </item>
       <item> no </item>
     </one-of>
    </rule>
   </grammar>
		 
    <prompt bargein="false">
      Do you want to play again?
    </prompt>
   </field>

 
  <filled namelist="confirm" mode="all">
   <if cond="confirm == 'yes'">
     <goto next="#guessNumber" />
   <elseif cond="confirm == 'no'" />
    <prompt>
       Thank you! Goodbye!
    </prompt>
   </if>
  </filled>

	
</form>

</vxml>